<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <title>Zusammenfassung – ISO 9001 | AlignedDocs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">
</head>

<body>
<a class="skip" href="#content">Zum Inhalt springen</a>

<header class="site-header">
  <div class="container header-inner">
    <div class="brand">
      <div class="brand-mark"><span></span></div>
      <div class="brand-text">
        <strong>AlignedDocs</strong><br>
        <small>ISO 9001:2015 – automatisiertes Handbuch</small>
      </div>
    </div>
  </div>
</header>

<main id="content" class="container">

  <section class="hero small">
    <h1>Zusammenfassung Ihrer Angaben</h1>
    <p class="lead">
      Bitte prüfen Sie Ihre Angaben sorgfältig.
      Die E-Mail-Adresse wird aus Sicherheitsgründen nur teilweise angezeigt.
    </p>
  </section>

  <section class="section card" id="summary"></section>

  <div class="actions">
    <a href="de.formular.html" class="btn btn-ghost">Zurück & bearbeiten</a>
    <button class="btn btn-primary" id="confirmBtn">
      Angaben bestätigen
    </button>
  </div>

</main>

<footer class="site-footer">
  <div class="container footer-inner">
    <small>© 2026 AlignedDocs</small>
  </div>
</footer>

<script>
/* ---------- DATA LOAD ---------- */
const data = JSON.parse(sessionStorage.getItem("isoFormData") || "{}");
const summaryEl = document.getElementById("summary");

/* ---------- EMAIL MASKING ---------- */
function maskEmail(email) {
  if (!email || !email.includes("@")) return "—";
  const [name, domain] = email.split("@");
  const maskedName =
    name.length <= 2
      ? name[0] + "*"
      : name[0] + "*".repeat(name.length - 2) + name.slice(-1);
  return maskedName + "@" + domain;
}

/* ---------- RENDER SUMMARY ---------- */
Object.entries(data).forEach(([key, value]) => {
  if (!value) return;

  const row = document.createElement("div");
  row.style.marginBottom = "14px";

  let displayValue = value;

  if (key === "email") {
    displayValue = maskEmail(value);
  }

  row.innerHTML = `
    <strong>${key}</strong><br>
    <span style="opacity:.9">${displayValue}</span>
  `;

  summaryEl.appendChild(row);
});

/* ---------- FINAL CONFIRM ---------- */
document.getElementById("confirmBtn").onclick = () => {
  alert("Angaben bestätigt. Im nächsten Schritt erfolgt die Verarbeitung.");
  // hier später: fetch() → n8n Webhook
};
</script>

</body>
</html>
